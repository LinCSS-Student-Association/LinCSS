---
  freeze: true  # never re-render during project render
  execute: 
    enabled: false 
---
# Arrival Guide
- Important
- Info

## Discover Norrköping  
This map showcases our favorite spots we think every new student should know. Explore at your own pace and uncover the hidden gems that make us students feel like home.

```{r}
#| echo: false
#| warning: false
#| message: false
library(leaflet)
library(tibble)

# Creating a comprehensive data structure for all locations
locations <- tibble::tribble(
  ~category, ~name, ~description, ~lng, ~lat,
  # Campus locations
  "Academic", "Campus Norrköping", "Main building for Computational Social Science", 16.1782, 58.5889,
  "Academic", "Kåkenhus", "Library and student services", 16.1776, 58.5883,
  "Academic", "Computational Lab", "Access to specialized software and high-performance computing", 16.1790, 58.5894,
  "Academic", "Department of Social Sciences", "Faculty offices and seminar rooms", 16.1785, 58.5887,
  "Academic", "Student Union", "Student representation and activities", 16.1780, 58.5886,
  
  # Transportation
  "Transport", "Norrköping Central Station", "Trains and buses", 16.1832, 58.5965,
  "Transport", "Campus Bus Stop", "Closest tram stop to campus", 16.1779, 58.5895,
  
  # Food & Groceries
  "Shopping", "Hemköp", "Affordable grocery store", 16.1739, 58.5878,
  "Shopping", "Spiralen Shopping Center", "Retail and services", 16.1818, 58.5889,
  
  # Healthcare
  "Health", "Vårdcentralen", "Healthcare center", 16.1740, 58.5950,
  "Health", "University Health Services", "Student health support", 16.1778, 58.5884,
  
  # Study spots
  "Study", "Café Vetekornet", "Popular student café with good Wi-Fi", 16.1778, 58.5888,
  "Study", "City Library", "Alternative study space", 16.1850, 58.5880,
  "Study", "DataLab", "Collaborative space for data projects", 16.1787, 58.5892,
  
  # Administrative
  "Administrative", "Migration Agency", "For residence permit matters", 16.1808, 58.5880,
  "Administrative", "IT Support Office", "Technical assistance for students", 16.1786, 58.5888,
  
  # Recreation
  "Recreation", "Strömparken", "Park by the river, good for breaks", 16.1743, 58.5909,
  "Recreation", "Visualization Center C", "Interactive exhibitions and events", 16.1760, 58.5884
)

# Create a function to map categories to hex color codes
getColor <- function(category) {
  switch(category,
    "Academic" ~ "#3388FF",     # Blue
    "Housing" ~ "#FFA500",      # Orange
    "Transport" ~ "#38A800",    # Green
    "Shopping" ~ "#5F9EA0",     # Cadet Blue
    "Health" ~ "#FF0000",       # Red
    "Study" ~ "#8A2BE2",        # Purple
    "Administrative" ~ "#4B0082", # Dark Purple
    "Recreation" ~ "#006400",   # Dark Green
    "#808080"  # Default gray if category doesn't match
  )
}

# Apply the function to create icons with proper hex colors
icons <- awesomeIcons(
  icon = "ios-close",
  iconColor = "#000000",
  library = "ion",
  markerColor = sapply(locations$category, getColor)
)

# Creating the leaflet map with color-coded markers
leaflet(locations) %>%
  addTiles() %>%
  addCircleMarkers(
    lng = ~lng,
    lat = ~lat,
    color = ~case_when(
      category == "Academic" = "#3388FF",
      category == "Housing" = "#FFA500",
      category == "Transport" = "#38A800",
      category == "Shopping" = "#5F9EA0",
      category == "Health" = "#FF0000",
      category == "Study" = "#8A2BE2",
      category == "Administrative" = "#4B0082",
      category == "Recreation" = "#006400",
      TRUE = "#808080"  # Default fallback
    ),
    radius = 8,
    stroke = FALSE,
    fillOpacity = 0.8,
    popup = ~paste0("<b>", name, "</b><br>", description, "<br><i>Category: ", category, "</i>")
  ) %>%
  addLegend(
    position = "bottomright",
    colors = c("#3388FF", "#FFA500", "#38A800", "#5F9EA0", "#FF0000", "#8A2BE2", "#4B0082", "#006400"),
    labels = c("Academic", "Housing", "Transport", "Shopping", "Health", "Study", "Administrative", "Recreation"),
    title = "Location Types"
  )
```
